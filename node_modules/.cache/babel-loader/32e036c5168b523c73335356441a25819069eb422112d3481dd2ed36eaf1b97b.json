{"ast":null,"code":"import _objectSpread from\"C:/Users/Porhc/OneDrive/\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B/oil/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"C:/Users/Porhc/OneDrive/\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B/oil/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Porhc/OneDrive/\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B/oil/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Porhc/OneDrive/\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B/oil/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from'react';import{Link}from'react-router-dom';import avatar from'../assets/User.png';import toast,{Toaster}from'react-hot-toast';import{useFormik}from'formik';import{profileValidation}from'../helper/validate';import convertToBase64 from'../helper/convert';import useFetch from'../hooks/fetch.hook';import{updateUser}from'../helper/helper';import{useNavigate}from'react-router-dom';import Header from'./Header';import styles from'../styles/UserName.module.css';import extend from'../styles/profile.model.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Profile(){var _useState=useState(),_useState2=_slicedToArray(_useState,2),file=_useState2[0],setFile=_useState2[1];// const { username } = useAuthStore(state => state.auth);\nvar _useFetch=useFetch(),_useFetch2=_slicedToArray(_useFetch,1),_useFetch2$=_useFetch2[0],isLoading=_useFetch2$.isLoading,apiData=_useFetch2$.apiData,serverError=_useFetch2$.serverError;var navigate=useNavigate();var formik=useFormik({initialValues:{firstName:(apiData===null||apiData===void 0?void 0:apiData.firstName)||'',lastName:(apiData===null||apiData===void 0?void 0:apiData.lastName)||'',email:(apiData===null||apiData===void 0?void 0:apiData.email)||'',mobile:(apiData===null||apiData===void 0?void 0:apiData.mobile)||'',address:(apiData===null||apiData===void 0?void 0:apiData.address)||''},enableReinitialize:true,validate:profileValidation,validateOnBlur:false,validateOnChange:false,onSubmit:function(){var _onSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(values){var updatePromise;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return Object.assign(values,{profile:file||(apiData===null||apiData===void 0?void 0:apiData.profile)||''});case 2:values=_context.sent;updatePromise=updateUser(values);toast.promise(updatePromise,{loading:'Обновление',success:/*#__PURE__*/_jsx(\"b\",{children:\"\\u041F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044C \\u0443\\u0441\\u043F\\u0435\\u0448\\u043D\\u043E \\u043E\\u0431\\u043D\\u043E\\u0432\\u043B\\u0435\\u043D\"}),error:/*#__PURE__*/_jsx(\"b\",{children:\"\\u041D\\u0435\\u0432\\u043E\\u0437\\u043C\\u043E\\u0436\\u043D\\u043E \\u043E\\u0431\\u043D\\u043E\\u0432\\u0438\\u0442\\u044C\"})});console.log(values);case 6:case\"end\":return _context.stop();}}},_callee);}));function onSubmit(_x){return _onSubmit.apply(this,arguments);}return onSubmit;}()});// не поддержтвается файл\nvar onUpload=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(e){var base64;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return convertToBase64(e.target.files[0]);case 2:base64=_context2.sent;setFile(base64);case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function onUpload(_x2){return _ref.apply(this,arguments);};}();//ручной выход\nfunction userLogout(){localStorage.removeItem('token');navigate('/');}if(isLoading)return/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold\",children:\"isLoading\"});if(serverError)return/*#__PURE__*/_jsx(\"h1\",{className:\"text-xl text-red-500\",children:serverError.massage});return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"container mx-auto\",children:[/*#__PURE__*/_jsx(Toaster,{position:\"center\",reverseOrder:false}),/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center items-center h-screen\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"\".concat(styles.glass,\" \").concat(extend.glass,\" sm:w-3/4 md:w-1/2 lg:w-1/3\"),style:{paddingTop:'3em'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"title flex flex-col items-center\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-5xl fotn-bold\",children:\"\\u041F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044C\"}),/*#__PURE__*/_jsx(\"span\",{className:\"py-4 text-xl w-3/3 text-center text-gray-500\",children:\"\\u0412\\u044B \\u043C\\u043E\\u0436\\u0435\\u0442\\u0435 \\u043E\\u0431\\u043D\\u043E\\u0432\\u0438\\u0442\\u044C \\u0441\\u0432\\u043E\\u0438 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0435.\"})]}),/*#__PURE__*/_jsxs(\"form\",{className:\"py-1\",onSubmit:formik.handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"profile flex justify-center py-4\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"profile\",children:/*#__PURE__*/_jsx(\"img\",{src:avatar,className:\"\".concat(styles.profile_img,\" \").concat(extend.profile_img),alt:\"avatar\"})}),/*#__PURE__*/_jsx(\"input\",{onChange:onUpload,type:\"file\",id:\"profile\",name:\"profile\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"textbox flex flex-col items-center gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"name flex w-full sm:flex-row sm:w-3/4 gap-10\",children:[/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({},formik.getFieldProps('firstName')),{},{className:\"\".concat(styles.textbox,\" \").concat(extend.textbox),type:\"text\",placeholder:\"\\u0418\\u043C\\u044F\"})),/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({},formik.getFieldProps('lastName')),{},{className:\"\".concat(styles.textbox,\" \").concat(extend.textbox),type:\"text\",placeholder:\"\\u0424\\u0430\\u043C\\u0438\\u043B\\u0438\\u044F\"}))]}),/*#__PURE__*/_jsxs(\"div\",{className:\"name flex w-full sm:flex-row sm:w-3/4 gap-10\",children:[/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({},formik.getFieldProps('mobile')),{},{className:\"\".concat(styles.textbox,\" \").concat(extend.textbox),type:\"text\",placeholder:\"\\u043D\\u043E\\u043C\\u0435\\u0440 \\u0442\\u0435\\u043B\\u0435\\u0444\\u043E\\u043D\\u0430\"})),/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({},formik.getFieldProps('email')),{},{className:\"\".concat(styles.textbox,\" \").concat(extend.textbox),type:\"text\",placeholder:\"Email\"}))]}),/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({},formik.getFieldProps('address')),{},{className:\"\".concat(styles.textbox,\" \").concat(extend.textbox),type:\"text\",placeholder:\"\\u0410\\u0434\\u0440\\u0435\\u0441\"})),/*#__PURE__*/_jsx(\"button\",{className:styles.btn,type:\"submit\",children:\"\\u041E\\u0431\\u043D\\u043E\\u0432\\u0438\\u0442\\u044C \\u043F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044C\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-4\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"text-gray-500\",children:[\"\\u041F\\u0440\\u0438\\u0445\\u043E\\u0434\\u0438\\u0442\\u0435 \\u043F\\u043E\\u0437\\u0436\\u0435 \",/*#__PURE__*/_jsx(\"button\",{onClick:userLogout,className:\"text-red-500\",to:\"/\",children:\"\\u0412\\u044B\\u0439\\u0442\\u0438\"})]})})]})]})})]})]});};","map":{"version":3,"names":["React","useState","Link","avatar","toast","Toaster","useFormik","profileValidation","convertToBase64","useFetch","updateUser","useNavigate","Header","styles","extend","Profile","file","setFile","isLoading","apiData","serverError","navigate","formik","initialValues","firstName","lastName","email","mobile","address","enableReinitialize","validate","validateOnBlur","validateOnChange","onSubmit","values","Object","assign","profile","updatePromise","promise","loading","success","error","console","log","onUpload","e","target","files","base64","userLogout","localStorage","removeItem","massage","glass","paddingTop","handleSubmit","profile_img","getFieldProps","textbox","btn"],"sources":["C:/Users/Porhc/OneDrive/Рабочий стол/oil/client/src/components/Profile.js"],"sourcesContent":["import React, { useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport avatar from '../assets/User.png';\nimport toast, { Toaster } from 'react-hot-toast';\nimport { useFormik } from 'formik';\nimport{ profileValidation } from '../helper/validate';\nimport convertToBase64 from '../helper/convert';\nimport useFetch from '../hooks/fetch.hook';\nimport { updateUser } from '../helper/helper';\nimport { useNavigate } from 'react-router-dom';\nimport Header from './Header';\n\nimport styles from '../styles/UserName.module.css';\nimport extend from '../styles/profile.model.css'\n\n\nexport default function Profile() {\n\n    const [file, setFile] = useState();\n    // const { username } = useAuthStore(state => state.auth);\n    const [{isLoading, apiData, serverError}] = useFetch()\n    const navigate = useNavigate()\n\n    const formik = useFormik({\n        initialValues : {\n            firstName : apiData?.firstName || '',\n            lastName : apiData?.lastName || '',\n            email : apiData?.email || '',\n            mobile: apiData?.mobile || '',\n            address : apiData?.address || ''\n        },\n        enableReinitialize: true,\n        validate : profileValidation,\n        validateOnBlur: false,\n        validateOnChange: false,\n        onSubmit : async values => {\n\n        \n            values = await Object.assign(values, { profile : file || apiData?.profile || ''})\n            let updatePromise = updateUser(values);\n\n            toast.promise(updatePromise, {\n                loading: 'Обновление',\n                success : <b>Профиль успешно обновлен</b>,\n                error : <b>Невозможно обновить</b>\n            });\n\n            console.log(values)\n        }\n    })\n\n// не поддержтвается файл\n\n    const onUpload = async e => {\n        const base64 = await convertToBase64(e.target.files[0]);\n        setFile(base64);\n    }\n\n    //ручной выход\n    function userLogout(){\n        localStorage.removeItem('token');\n        navigate('/');\n    }\n\n    if(isLoading) return <h1 className='text-2xl font-bold'>isLoading</h1>;\n    if(serverError) return <h1 className='text-xl text-red-500'>{serverError.massage}</h1>\n\n    return (\n        <div>\n            <Header />\n        <div className=\"container mx-auto\">\n            <Toaster position='center' reverseOrder={false}></Toaster>\n\n            <div className='flex justify-center items-center h-screen'>\n                <div className={`${styles.glass} ${extend.glass} sm:w-3/4 md:w-1/2 lg:w-1/3`} style={{ paddingTop: '3em'}}>\n                    \n                    <div className=\"title flex flex-col items-center\">\n                        <h4 className='text-5xl fotn-bold'>Профиль</h4>\n                        <span className='py-4 text-xl w-3/3 text-center text-gray-500'>\n                            Вы можете обновить свои данные.\n                        </span>\n                    </div>\n\n                    <form className='py-1' onSubmit={formik.handleSubmit}>\n                        <div className='profile flex justify-center py-4'>\n                            <label htmlFor=\"profile\">\n                                <img src={avatar} className={`${styles.profile_img} ${extend.profile_img}`} alt=\"avatar\" />\n                            </label>\n                            <input onChange={onUpload} type=\"file\" id='profile' name='profile' />\n                        </div>\n\n                        <div className=\"textbox flex flex-col items-center gap-6\">\n                            <div className=\"name flex w-full sm:flex-row sm:w-3/4 gap-10\">\n                                <input {...formik.getFieldProps('firstName')} className={`${styles.textbox} ${extend.textbox}`} type=\"text\" placeholder='Имя' />\n                                <input {...formik.getFieldProps('lastName')} className={`${styles.textbox} ${extend.textbox}`} type=\"text\" placeholder='Фамилия' />\n                            </div>\n                     \n                            <div className=\"name flex w-full sm:flex-row sm:w-3/4 gap-10\">\n                                <input {...formik.getFieldProps('mobile')} className={`${styles.textbox} ${extend.textbox}`} type=\"text\" placeholder='номер телефона' />\n                                <input {...formik.getFieldProps('email')} className={`${styles.textbox} ${extend.textbox}`} type=\"text\" placeholder='Email' />\n                            </div>\n\n                            <input {...formik.getFieldProps('address')} className={`${styles.textbox} ${extend.textbox}`} type=\"text\" placeholder='Адрес' />\n                            <button className={styles.btn} type='submit'>Обновить профиль</button>\n                        </div>\n\n                        <div className=\"text-center py-4\">\n                            <span className='text-gray-500'>Приходите позже <button onClick={userLogout} className='text-red-500' to='/'>Выйти</button></span>\n                        </div>\n                    </form>\n\n                </div>\n            </div>\n        </div>\n        </div>\n    );\n};"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}