{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Porhc/OneDrive/\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B/oil/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _objectSpread from\"C:/Users/Porhc/OneDrive/\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B/oil/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"C:/Users/Porhc/OneDrive/\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B/oil/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Porhc/OneDrive/\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B/oil/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import'../styles/mail.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Mail=function Mail(){var _useState=useState({firstName:'',lastName:'',email:'',subject:'',text:''}),_useState2=_slicedToArray(_useState,2),formData=_useState2[0],setFormData=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),message=_useState4[0],setMessage=_useState4[1];useEffect(function(){var fetchUserData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var token,response,data,error;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:token=localStorage.getItem('token');if(token){_context.next=4;break;}setMessage('You must be logged in to send a message.');return _context.abrupt(\"return\");case 4:_context.prev=4;_context.next=7;return fetch('http://localhost:8080/api/currentUser',{headers:{'Authorization':\"Bearer \".concat(token)}});case 7:response=_context.sent;if(!response.ok){_context.next=15;break;}_context.next=11;return response.json();case 11:data=_context.sent;setFormData(function(prevData){return _objectSpread(_objectSpread({},prevData),{},{firstName:data.firstName,lastName:data.lastName,email:data.email});});_context.next=19;break;case 15:_context.next=17;return response.json();case 17:error=_context.sent;setMessage(\"Error: \".concat(error.error));case 19:_context.next=24;break;case 21:_context.prev=21;_context.t0=_context[\"catch\"](4);setMessage(\"Error: \".concat(_context.t0.message));case 24:case\"end\":return _context.stop();}}},_callee,null,[[4,21]]);}));return function fetchUserData(){return _ref.apply(this,arguments);};}();fetchUserData();},[]);var handleSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(e){var token,response,result;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:e.preventDefault();token=localStorage.getItem('token');if(token){_context2.next=5;break;}setMessage('You must be logged in to send a message.');return _context2.abrupt(\"return\");case 5:_context2.prev=5;_context2.next=8;return fetch('http://localhost:8080/api/sendMail',{method:'POST',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(token)},body:JSON.stringify({username:\"\".concat(formData.firstName,\" \").concat(formData.lastName),userEmail:formData.email,subject:formData.subject,text:formData.text})});case 8:response=_context2.sent;_context2.next=11;return response.json();case 11:result=_context2.sent;if(response.ok){setMessage('Message sent successfully!');}else{setMessage(\"Error: \".concat(result.error));}_context2.next=18;break;case 15:_context2.prev=15;_context2.t0=_context2[\"catch\"](5);setMessage(\"Error: \".concat(_context2.t0.message));case 18:case\"end\":return _context2.stop();}}},_callee2,null,[[5,15]]);}));return function handleSubmit(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"mail-form\",children:[/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.firstName,onChange:function onChange(e){return setFormData(_objectSpread(_objectSpread({},formData),{},{firstName:e.target.value}));},placeholder:\"\\u0418\\u043C\\u044F\",required:true}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.lastName,onChange:function onChange(e){return setFormData(_objectSpread(_objectSpread({},formData),{},{lastName:e.target.value}));},placeholder:\"\\u0424\\u0430\\u043C\\u0438\\u043B\\u0438\\u044F\",required:true}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",value:formData.email,onChange:function onChange(e){return setFormData(_objectSpread(_objectSpread({},formData),{},{email:e.target.value}));},placeholder:\"Email\",required:true}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.subject,onChange:function onChange(e){return setFormData(_objectSpread(_objectSpread({},formData),{},{subject:e.target.value}));},placeholder:\"\\u0422\\u0435\\u043C\\u0430\",required:true}),/*#__PURE__*/_jsx(\"textarea\",{value:formData.text,onChange:function onChange(e){return setFormData(_objectSpread(_objectSpread({},formData),{},{text:e.target.value}));},placeholder:\"\\u0421\\u043E\\u043E\\u0431\\u0449\\u0435\\u043D\\u0438\\u0435\",required:true}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"\\u041E\\u0442\\u043F\\u0440\\u0430\\u0432\\u0438\\u0442\\u044C\"})]}),message&&/*#__PURE__*/_jsx(\"p\",{children:message})]});};export default Mail;","map":{"version":3,"names":["React","useState","useEffect","Mail","firstName","lastName","email","subject","text","formData","setFormData","message","setMessage","fetchUserData","token","localStorage","getItem","fetch","headers","response","ok","json","data","prevData","error","handleSubmit","e","preventDefault","method","body","JSON","stringify","username","userEmail","result","target","value"],"sources":["C:/Users/Porhc/OneDrive/Рабочий стол/oil/client/src/components/Mail.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport '../styles/mail.css'\r\n\r\nconst Mail = () => {\r\n    const [formData, setFormData] = useState({\r\n        firstName: '',\r\n        lastName: '',\r\n        email: '',\r\n        subject: '',\r\n        text: ''\r\n    });\r\n\r\n    const [message, setMessage] = useState('');\r\n\r\n    useEffect(() => {\r\n        const fetchUserData = async () => {\r\n            const token = localStorage.getItem('token');\r\n            if (!token) {\r\n                setMessage('You must be logged in to send a message.');\r\n                return;\r\n            }\r\n\r\n            try {\r\n                const response = await fetch('http://localhost:8080/api/currentUser', {\r\n                    headers: {\r\n                        'Authorization': `Bearer ${token}`\r\n                    }\r\n                });\r\n                if (response.ok) {\r\n                    const data = await response.json();\r\n                    setFormData(prevData => ({\r\n                        ...prevData,\r\n                        firstName: data.firstName,\r\n                        lastName: data.lastName,\r\n                        email: data.email\r\n                    }));\r\n                } else {\r\n                    const error = await response.json();\r\n                    setMessage(`Error: ${error.error}`);\r\n                }\r\n            } catch (error) {\r\n                setMessage(`Error: ${error.message}`);\r\n            }\r\n        };\r\n\r\n        fetchUserData();\r\n    }, []);\r\n\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n\r\n        const token = localStorage.getItem('token');\r\n\r\n        if (!token) {\r\n            setMessage('You must be logged in to send a message.');\r\n            return;\r\n        }\r\n\r\n        try {\r\n            const response = await fetch('http://localhost:8080/api/sendMail', {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                    'Authorization': `Bearer ${token}`\r\n                },\r\n                body: JSON.stringify({\r\n                    username: `${formData.firstName} ${formData.lastName}`,\r\n                    userEmail: formData.email,\r\n                    subject: formData.subject,\r\n                    text: formData.text\r\n                })\r\n            });\r\n\r\n            const result = await response.json();\r\n\r\n            if (response.ok) {\r\n                setMessage('Message sent successfully!');\r\n            } else {\r\n                setMessage(`Error: ${result.error}`);\r\n            }\r\n        } catch (error) {\r\n            setMessage(`Error: ${error.message}`);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"mail-form\">\r\n            <form onSubmit={handleSubmit}>\r\n                    <input\r\n                        type=\"text\"\r\n                        value={formData.firstName}\r\n                        onChange={(e) => setFormData({ ...formData, firstName: e.target.value })}\r\n                        placeholder=\"Имя\"\r\n                        required\r\n                    />\r\n                    <input\r\n                        type=\"text\"\r\n                        value={formData.lastName}\r\n                        onChange={(e) => setFormData({ ...formData, lastName: e.target.value })}\r\n                        placeholder=\"Фамилия\"\r\n                        required\r\n                    />\r\n                    <input\r\n                        type=\"email\"\r\n                        value={formData.email}\r\n                        onChange={(e) => setFormData({ ...formData, email: e.target.value })}\r\n                        placeholder=\"Email\"\r\n                        required\r\n                    />\r\n                    <input\r\n                        type=\"text\"\r\n                        value={formData.subject}\r\n                        onChange={(e) => setFormData({ ...formData, subject: e.target.value })}\r\n                        placeholder=\"Тема\"\r\n                        required\r\n                    />\r\n                    <textarea\r\n                        value={formData.text}\r\n                        onChange={(e) => setFormData({ ...formData, text: e.target.value })}\r\n                        placeholder=\"Сообщение\"\r\n                        required\r\n                    ></textarea>\r\n                    <button type=\"submit\">Отправить</button>\r\n                </form>\r\n\r\n                {message && <p>{message}</p>}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Mail;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}