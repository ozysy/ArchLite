{"ast":null,"code":"import _objectSpread from\"C:/Users/Porhc/OneDrive/\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B/oil/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"C:/Users/Porhc/OneDrive/\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B/oil/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Porhc/OneDrive/\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B/oil/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Porhc/OneDrive/\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B/oil/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import'../styles/mail.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Mail=function Mail(){var _useState=useState({firstName:'',lastName:'',email:'',subject:'',text:''}),_useState2=_slicedToArray(_useState,2),formData=_useState2[0],setFormData=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),message=_useState4[0],setMessage=_useState4[1];useEffect(function(){var fetchUserData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var token,response,data,error;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:token=localStorage.getItem('token');if(token){_context.next=3;break;}return _context.abrupt(\"return\");case 3:_context.prev=3;_context.next=6;return fetch('http://localhost:8080/api/currentUser',{headers:{'Authorization':\"Bearer \".concat(token)}});case 6:response=_context.sent;if(!response.ok){_context.next=14;break;}_context.next=10;return response.json();case 10:data=_context.sent;setFormData({firstName:data.firstName,lastName:data.lastName,email:data.email,subject:'',text:''});_context.next=18;break;case 14:_context.next=16;return response.json();case 16:error=_context.sent;setMessage(\"Error: \".concat(error.error));case 18:_context.next=23;break;case 20:_context.prev=20;_context.t0=_context[\"catch\"](3);setMessage(\"Error: \".concat(_context.t0.message));case 23:case\"end\":return _context.stop();}}},_callee,null,[[3,20]]);}));return function fetchUserData(){return _ref.apply(this,arguments);};}();fetchUserData();},[]);var handleSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(e){var token,headers,response,result;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:e.preventDefault();token=localStorage.getItem('token');headers={'Content-Type':'application/json'};if(token){headers['Authorization']=\"Bearer \".concat(token);}_context2.prev=4;_context2.next=7;return fetch('http://localhost:8080/api/sendMail',{method:'POST',headers:headers,body:JSON.stringify({username:\"\".concat(formData.firstName,\" \").concat(formData.lastName),userEmail:formData.email,subject:formData.subject,text:formData.text})});case 7:response=_context2.sent;_context2.next=10;return response.json();case 10:result=_context2.sent;if(response.ok){setMessage('Message sent successfully!');}else{setMessage(\"Error: \".concat(result.error));}_context2.next=17;break;case 14:_context2.prev=14;_context2.t0=_context2[\"catch\"](4);setMessage(\"Error: \".concat(_context2.t0.message));case 17:case\"end\":return _context2.stop();}}},_callee2,null,[[4,14]]);}));return function handleSubmit(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"mail-form\",children:[/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.firstName,onChange:function onChange(e){return setFormData(_objectSpread(_objectSpread({},formData),{},{firstName:e.target.value}));},placeholder:\"\\u0418\\u043C\\u044F\",required:true,disabled:!!localStorage.getItem('token')// Disable if user is logged in\n}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.lastName,onChange:function onChange(e){return setFormData(_objectSpread(_objectSpread({},formData),{},{lastName:e.target.value}));},placeholder:\"\\u0424\\u0430\\u043C\\u0438\\u043B\\u0438\\u044F\",required:true,disabled:!!localStorage.getItem('token')// Disable if user is logged in\n}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",value:formData.email,onChange:function onChange(e){return setFormData(_objectSpread(_objectSpread({},formData),{},{email:e.target.value}));},placeholder:\"Email\",required:true,disabled:!!localStorage.getItem('token')// Disable if user is logged in\n}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.subject,onChange:function onChange(e){return setFormData(_objectSpread(_objectSpread({},formData),{},{subject:e.target.value}));},placeholder:\"\\u0422\\u0435\\u043C\\u0430\",required:true}),/*#__PURE__*/_jsx(\"textarea\",{value:formData.text,onChange:function onChange(e){return setFormData(_objectSpread(_objectSpread({},formData),{},{text:e.target.value}));},placeholder:\"\\u0421\\u043E\\u043E\\u0431\\u0449\\u0435\\u043D\\u0438\\u0435\",required:true}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"\\u041E\\u0442\\u043F\\u0440\\u0430\\u0432\\u0438\\u0442\\u044C\"})]}),message&&/*#__PURE__*/_jsx(\"p\",{children:message})]});};export default Mail;","map":{"version":3,"names":["React","useState","useEffect","Mail","firstName","lastName","email","subject","text","formData","setFormData","message","setMessage","fetchUserData","token","localStorage","getItem","fetch","headers","response","ok","json","data","error","handleSubmit","e","preventDefault","method","body","JSON","stringify","username","userEmail","result","target","value"],"sources":["C:/Users/Porhc/OneDrive/Рабочий стол/oil/client/src/components/Mail.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport '../styles/mail.css';\n\nconst Mail = () => {\n    const [formData, setFormData] = useState({\n        firstName: '',\n        lastName: '',\n        email: '',\n        subject: '',\n        text: ''\n    });\n\n    const [message, setMessage] = useState('');\n\n    useEffect(() => {\n        const fetchUserData = async () => {\n            const token = localStorage.getItem('token');\n            if (!token) {\n                return;\n            }\n\n            try {\n                const response = await fetch('http://localhost:8080/api/currentUser', {\n                    headers: {\n                        'Authorization': `Bearer ${token}`\n                    }\n                });\n\n                if (response.ok) {\n                    const data = await response.json();\n                    setFormData({\n                        firstName: data.firstName,\n                        lastName: data.lastName,\n                        email: data.email,\n                        subject: '',\n                        text: ''\n                    });\n                } else {\n                    const error = await response.json();\n                    setMessage(`Error: ${error.error}`);\n                }\n            } catch (error) {\n                setMessage(`Error: ${error.message}`);\n            }\n        };\n\n        fetchUserData();\n    }, []);\n\n    const handleSubmit = async (e) => {\n        e.preventDefault();\n\n        const token = localStorage.getItem('token');\n        const headers = {\n            'Content-Type': 'application/json'\n        };\n\n        if (token) {\n            headers['Authorization'] = `Bearer ${token}`;\n        }\n\n        try {\n            const response = await fetch('http://localhost:8080/api/sendMail', {\n                method: 'POST',\n                headers: headers,\n                body: JSON.stringify({\n                    username: `${formData.firstName} ${formData.lastName}`,\n                    userEmail: formData.email,\n                    subject: formData.subject,\n                    text: formData.text\n                })\n            });\n\n            const result = await response.json();\n\n            if (response.ok) {\n                setMessage('Message sent successfully!');\n            } else {\n                setMessage(`Error: ${result.error}`);\n            }\n        } catch (error) {\n            setMessage(`Error: ${error.message}`);\n        }\n    };\n\n    return (\n        <div className=\"mail-form\">\n            <form onSubmit={handleSubmit}>\n                <input\n                    type=\"text\"\n                    value={formData.firstName}\n                    onChange={(e) => setFormData({ ...formData, firstName: e.target.value })}\n                    placeholder=\"Имя\"\n                    required\n                    disabled={!!localStorage.getItem('token')} // Disable if user is logged in\n                />\n                <input\n                    type=\"text\"\n                    value={formData.lastName}\n                    onChange={(e) => setFormData({ ...formData, lastName: e.target.value })}\n                    placeholder=\"Фамилия\"\n                    required\n                    disabled={!!localStorage.getItem('token')} // Disable if user is logged in\n                />\n                <input\n                    type=\"email\"\n                    value={formData.email}\n                    onChange={(e) => setFormData({ ...formData, email: e.target.value })}\n                    placeholder=\"Email\"\n                    required\n                    disabled={!!localStorage.getItem('token')} // Disable if user is logged in\n                />\n                <input\n                    type=\"text\"\n                    value={formData.subject}\n                    onChange={(e) => setFormData({ ...formData, subject: e.target.value })}\n                    placeholder=\"Тема\"\n                    required\n                />\n                <textarea\n                    value={formData.text}\n                    onChange={(e) => setFormData({ ...formData, text: e.target.value })}\n                    placeholder=\"Сообщение\"\n                    required\n                ></textarea>\n                <button type=\"submit\">Отправить</button>\n            </form>\n\n            {message && <p>{message}</p>}\n        </div>\n    );\n};\n\nexport default Mail;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}