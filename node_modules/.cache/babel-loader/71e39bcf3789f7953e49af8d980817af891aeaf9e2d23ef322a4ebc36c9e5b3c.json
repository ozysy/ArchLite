{"ast":null,"code":"import React,{useState}from'react';import{Link}from'react-router-dom';import avatar from'../assets/User.png';import toast,{Toaster}from'react-hot-toast';import{useFormik}from'formik';import{profileValidation}from'../helper/validate';import convertToBase64 from'../helper/convert';import useFetch from'../hooks/fetch.hook';import{updateUser}from'../helper/helper';import{useNavigate}from'react-router-dom';import styles from'../styles/UserName.module.css';import extend from'../styles/profile.model.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function Profile(){const[file,setFile]=useState();// const { username } = useAuthStore(state => state.auth);\nconst[{isLoading,apiData,serverError}]=useFetch();const navigate=useNavigate();const formik=useFormik({initialValues:{firstName:(apiData===null||apiData===void 0?void 0:apiData.firstName)||'',lastName:(apiData===null||apiData===void 0?void 0:apiData.lastName)||'',email:(apiData===null||apiData===void 0?void 0:apiData.email)||'',mobile:(apiData===null||apiData===void 0?void 0:apiData.mobile)||'',address:(apiData===null||apiData===void 0?void 0:apiData.address)||''},enableReinitialize:true,validate:profileValidation,validateOnBlur:false,validateOnChange:false,onSubmit:async values=>{values=await Object.assign(values,{profile:file||(apiData===null||apiData===void 0?void 0:apiData.profile)||''});let updatePromise=updateUser(values);toast.promise(updatePromise,{loading:'Обновление',success:/*#__PURE__*/_jsx(\"b\",{children:\"\\u041F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044C \\u0443\\u0441\\u043F\\u0435\\u0448\\u043D\\u043E \\u043E\\u0431\\u043D\\u043E\\u0432\\u043B\\u0435\\u043D\"}),error:/*#__PURE__*/_jsx(\"b\",{children:\"\\u041D\\u0435\\u0432\\u043E\\u0437\\u043C\\u043E\\u0436\\u043D\\u043E \\u043E\\u0431\\u043D\\u043E\\u0432\\u0438\\u0442\\u044C\"})});console.log(values);}});// не поддержтвается файл\nconst onUpload=async e=>{const base64=await convertToBase64(e.target.files[0]);setFile(base64);};//ручной выход\nfunction userLogout(){localStorage.removeItem('token');navigate('/Username');}if(isLoading)return/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold\",children:\"isLoading\"});if(serverError)return/*#__PURE__*/_jsx(\"h1\",{className:\"text-xl text-red-500\",children:serverError.massage});return/*#__PURE__*/_jsxs(\"div\",{className:\"container mx-auto\",children:[/*#__PURE__*/_jsx(Toaster,{position:\"top-center\",reverseOrder:false}),/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center items-center h-screen\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"\".concat(styles.glass,\" \").concat(extend.glass),style:{width:\"45%\",paddingTop:'3em'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"title flex flex-col items-center\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-5xl fotn-bold\",children:\"\\u041F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044C\"}),/*#__PURE__*/_jsx(\"span\",{className:\"py-4 text-xl w-2/3 text-center text-gray-500\",children:\"\\u0412\\u044B \\u043C\\u043E\\u0436\\u0435\\u0442\\u0435 \\u043E\\u0431\\u043D\\u043E\\u0432\\u0438\\u0442\\u044C \\u0441\\u0432\\u043E\\u0438 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0435.\"})]}),/*#__PURE__*/_jsxs(\"form\",{className:\"py-1\",onSubmit:formik.handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"profile flex justify-center py-4\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"profile\",children:/*#__PURE__*/_jsx(\"img\",{src:(apiData===null||apiData===void 0?void 0:apiData.profile)||file||avatar,className:\"\".concat(styles.profile_img,\" \").concat(extend.profile_img),alt:\"avatar\"})}),/*#__PURE__*/_jsx(\"input\",{onChange:onUpload,type:\"file\",id:\"profile\",name:\"profile\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"textbox flex flex-col items-center gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"name flex w-3/4 gap-10\",children:[/*#__PURE__*/_jsx(\"input\",{...formik.getFieldProps('firstName'),className:\"\".concat(styles.textbox,\" \").concat(extend.textbox),type:\"text\",placeholder:\"\\u0418\\u043C\\u044F\"}),/*#__PURE__*/_jsx(\"input\",{...formik.getFieldProps('lastName'),className:\"\".concat(styles.textbox,\" \").concat(extend.textbox),type:\"text\",placeholder:\"\\u0424\\u0430\\u043C\\u0438\\u043B\\u0438\\u044F\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"name flex w-3/4 gap-10\",children:[/*#__PURE__*/_jsx(\"input\",{...formik.getFieldProps('mobile'),className:\"\".concat(styles.textbox,\" \").concat(extend.textbox),type:\"text\",placeholder:\"\\u043D\\u043E\\u043C\\u0435\\u0440 \\u0442\\u0435\\u043B\\u0435\\u0444\\u043E\\u043D\\u0430\"}),/*#__PURE__*/_jsx(\"input\",{...formik.getFieldProps('email'),className:\"\".concat(styles.textbox,\" \").concat(extend.textbox),type:\"text\",placeholder:\"Email\"})]}),/*#__PURE__*/_jsx(\"input\",{...formik.getFieldProps('address'),className:\"\".concat(styles.textbox,\" \").concat(extend.textbox),type:\"text\",placeholder:\"\\u0410\\u0434\\u0440\\u0435\\u0441\"}),/*#__PURE__*/_jsx(\"button\",{className:styles.btn,type:\"submit\",children:\"\\u041E\\u0431\\u043D\\u043E\\u0432\\u0438\\u0442\\u044C \\u043F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044C\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-4\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"text-gray-500\",children:[\"\\u041F\\u0440\\u0438\\u0445\\u043E\\u0434\\u0438\\u0442\\u0435 \\u043F\\u043E\\u0437\\u0436\\u0435 \",/*#__PURE__*/_jsx(\"button\",{onClick:userLogout,className:\"text-red-500\",to:\"/Username\",children:\"\\u0412\\u044B\\u0439\\u0442\\u0438\"})]})})]})]})})]});}","map":{"version":3,"names":["React","useState","Link","avatar","toast","Toaster","useFormik","profileValidation","convertToBase64","useFetch","updateUser","useNavigate","styles","extend","jsx","_jsx","jsxs","_jsxs","Profile","file","setFile","isLoading","apiData","serverError","navigate","formik","initialValues","firstName","lastName","email","mobile","address","enableReinitialize","validate","validateOnBlur","validateOnChange","onSubmit","values","Object","assign","profile","updatePromise","promise","loading","success","children","error","console","log","onUpload","e","base64","target","files","userLogout","localStorage","removeItem","className","massage","position","reverseOrder","concat","glass","style","width","paddingTop","handleSubmit","htmlFor","src","profile_img","alt","onChange","type","id","name","getFieldProps","textbox","placeholder","btn","onClick","to"],"sources":["C:/Users/Porhc/OneDrive/Рабочий стол/oil/client/src/components/Profile.js"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport avatar from '../assets/User.png';\r\nimport toast, { Toaster } from 'react-hot-toast';\r\nimport { useFormik } from 'formik';\r\nimport{ profileValidation } from '../helper/validate';\r\nimport convertToBase64 from '../helper/convert';\r\nimport useFetch from '../hooks/fetch.hook';\r\nimport { updateUser } from '../helper/helper';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\nimport styles from '../styles/UserName.module.css';\r\nimport extend from '../styles/profile.model.css'\r\n\r\n\r\nexport default function Profile() {\r\n\r\n    const [file, setFile] = useState();\r\n    // const { username } = useAuthStore(state => state.auth);\r\n    const [{isLoading, apiData, serverError}] = useFetch()\r\n    const navigate = useNavigate()\r\n\r\n    const formik = useFormik({\r\n        initialValues : {\r\n            firstName : apiData?.firstName || '',\r\n            lastName : apiData?.lastName || '',\r\n            email : apiData?.email || '',\r\n            mobile: apiData?.mobile || '',\r\n            address : apiData?.address || ''\r\n        },\r\n        enableReinitialize: true,\r\n        validate : profileValidation,\r\n        validateOnBlur: false,\r\n        validateOnChange: false,\r\n        onSubmit : async values => {\r\n\r\n        \r\n            values = await Object.assign(values, { profile : file || apiData?.profile || ''})\r\n            let updatePromise = updateUser(values);\r\n\r\n            toast.promise(updatePromise, {\r\n                loading: 'Обновление',\r\n                success : <b>Профиль успешно обновлен</b>,\r\n                error : <b>Невозможно обновить</b>\r\n            });\r\n\r\n            console.log(values)\r\n        }\r\n    })\r\n\r\n// не поддержтвается файл\r\n\r\n    const onUpload = async e => {\r\n        const base64 = await convertToBase64(e.target.files[0]);\r\n        setFile(base64);\r\n    }\r\n\r\n    //ручной выход\r\n    function userLogout(){\r\n        localStorage.removeItem('token');\r\n        navigate('/Username');\r\n    }\r\n\r\n    if(isLoading) return <h1 className='text-2xl font-bold'>isLoading</h1>;\r\n    if(serverError) return <h1 className='text-xl text-red-500'>{serverError.massage}</h1>\r\n\r\n    return (\r\n        <div className=\"container mx-auto\">\r\n\r\n            <Toaster position='top-center' reverseOrder={false}></Toaster>\r\n\r\n            <div className='flex justify-center items-center h-screen'>\r\n            <div className={`${styles.glass} ${extend.glass}`} style={{ width: \"45%\", paddingTop: '3em'}}>\r\n                    \r\n                    <div className=\"title flex flex-col items-center\">\r\n                        <h4 className='text-5xl fotn-bold'>Профиль</h4>\r\n                        <span className='py-4 text-xl w-2/3 text-center text-gray-500'>\r\n                            Вы можете обновить свои данные.\r\n                        </span>\r\n                    </div>\r\n\r\n                    <form className='py-1' onSubmit={formik.handleSubmit}>\r\n                    <div className='profile flex justify-center py-4'>\r\n                  <label htmlFor=\"profile\">\r\n                  <img src={apiData?.profile || file || avatar} className={`${styles.profile_img} ${extend.profile_img}`} alt=\"avatar\" />\r\n                  </label>\r\n                  \r\n                  <input onChange={onUpload} type=\"file\" id='profile' name='profile' />\r\n              </div>\r\n\r\n                <div className=\"textbox flex flex-col items-center gap-6\">\r\n                    <div className=\"name flex w-3/4 gap-10\">\r\n                        <input {...formik.getFieldProps('firstName')} className={`${styles.textbox} ${extend.textbox}`} type=\"text\" placeholder='Имя' />\r\n                        <input {...formik.getFieldProps('lastName')} className={`${styles.textbox} ${extend.textbox}`} type=\"text\" placeholder='Фамилия' />\r\n                     </div>\r\n                     \r\n                     <div className=\"name flex w-3/4 gap-10\">\r\n                        <input {...formik.getFieldProps('mobile')} className={`${styles.textbox} ${extend.textbox}`} type=\"text\" placeholder='номер телефона' />\r\n                        <input {...formik.getFieldProps('email')} className={`${styles.textbox} ${extend.textbox}`} type=\"text\" placeholder='Email' />\r\n                    </div>\r\n\r\n                        <input {...formik.getFieldProps('address')} className={`${styles.textbox} ${extend.textbox}`} type=\"text\" placeholder='Адрес' />\r\n                        <button className={styles.btn} type='submit'>Обновить профиль</button>\r\n                  \r\n              </div>\r\n\r\n                           <div className=\"text-center py-4\">\r\n                            <span className='text-gray-500'>Приходите позже <button onClick={userLogout} className='text-red-500' to='/Username'>Выйти</button></span>\r\n                           </div>\r\n                    </form>\r\n\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}