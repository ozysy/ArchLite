{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Porhc/OneDrive/\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B/oil/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Porhc/OneDrive/\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B/oil/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Porhc/OneDrive/\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B/oil/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from'react';import toast,{Toaster}from'react-hot-toast';import{useAuthStore}from'../store/store';import{generateOTP,verifyOTP}from'../helper/helper';import{useNavigate}from'react-router-dom';import styles from'../styles/UserName.module.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Recovery(){var _useAuthStore=useAuthStore(function(state){return state.auth;}),username=_useAuthStore.username;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),OTP=_useState2[0],setOTP=_useState2[1];var navigate=useNavigate();useEffect(function(){generateOTP(username).then(function(OTP){// console.log(OTP);\nif(OTP)return toast.success('Код был выслан на вашу почту');return toast.error('Возникла проблема при генерации вашего кода');});},[username]);function onSubmit(_x){return _onSubmit.apply(this,arguments);}//ручная отправка\nfunction _onSubmit(){_onSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var _yield$verifyOTP,status;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();_context.prev=1;console.log(\"Verifying OTP with:\",{username:username,code:OTP});_context.next=5;return verifyOTP({username:username,code:OTP});case 5:_yield$verifyOTP=_context.sent;status=_yield$verifyOTP.status;if(status===201){toast.success('Проверка успешна');navigate('/reset');}else{toast.error('Код не правильный, проверьте свою почту');}_context.next=14;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](1);console.error(\"Error verifying OTP:\",_context.t0);toast.error('Код не правильный, проверьте свою почту');case 14:case\"end\":return _context.stop();}}},_callee,null,[[1,10]]);}));return _onSubmit.apply(this,arguments);}function resendOTP(){var sendPromise=generateOTP(username);toast.promise(sendPromise,{loading:'Отправка',success:/*#__PURE__*/_jsx(\"b\",{children:\"\\u041A\\u043E\\u0434 \\u0431\\u044B\\u043B \\u043E\\u0442\\u043F\\u0440\\u0430\\u0432\\u043B\\u0435\\u043D \\u043D\\u0430 \\u0432\\u0430\\u0448\\u0443 \\u043F\\u043E\\u0447\\u0442\\u0443\"}),error:/*#__PURE__*/_jsx(\"b\",{children:\"\\u041D\\u0435 \\u043F\\u043E\\u043B\\u0443\\u0447\\u0438\\u043B\\u043E\\u0441\\u044C \\u043E\\u0442\\u043F\\u0440\\u0430\\u0432\\u0438\\u0442\\u044C\"})});sendPromise.then(function(OTP){// console.log(OTP)\n});}return/*#__PURE__*/_jsxs(\"div\",{className:\"container mx-auto\",children:[/*#__PURE__*/_jsx(Toaster,{position:\"top-center\",reverseOrder:false}),/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center items-center h-screen\",children:/*#__PURE__*/_jsxs(\"div\",{className:styles.glass,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"title flex flex-col items-center\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-5xl fotn-bold\",children:\"\\u0412\\u043E\\u0441\\u0441\\u0442\\u0430\\u043D\\u043E\\u0432\\u043B\\u0435\\u043D\\u0438\\u0435 \\u043F\\u0430\\u0440\\u043E\\u043B\\u044F\"}),/*#__PURE__*/_jsx(\"span\",{className:\"py-4 text-xl w-2/3 text-center text-gray-500\",children:\"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u043A\\u043E\\u0434 \\u0434\\u043B\\u044F \\u0441\\u043C\\u0435\\u043D\\u044B \\u043F\\u0430\\u0440\\u043E\\u043B\\u044F.\"})]}),/*#__PURE__*/_jsx(\"form\",{className:\"pt-20\",onSubmit:onSubmit,children:/*#__PURE__*/_jsxs(\"div\",{className:\"textbox flex flex-col items-center gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"input text-center\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"py-4 text-sm text-left text-gray-500\",children:\"\\u0412\\u0435\\u0434\\u0438\\u0442\\u0435 6 \\u0437\\u043D\\u0430\\u0447\\u043D\\u044B\\u0439 \\u043A\\u043E\\u0434\"}),/*#__PURE__*/_jsx(\"input\",{onChange:function onChange(e){return setOTP(e.target.value);},className:styles.textbox,type:\"text\",placeholder:\"OTP\"})]}),/*#__PURE__*/_jsx(\"button\",{className:styles.btn,type:\"submit\",children:\"\\u0412\\u043E\\u0441\\u0441\\u0442\\u0430\\u043D\\u043E\\u0432\\u0438\\u0442\\u044C \\u043F\\u0430\\u0440\\u043E\\u043B\\u044C\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-4\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"text-gray-500\",children:[\"\\u041A\\u043E\\u0434 \\u043D\\u0435 \\u043F\\u0440\\u0438\\u0448\\u0435\\u043B? \",/*#__PURE__*/_jsx(\"button\",{onClick:resendOTP,className:\"text-red-500\",children:\"\\u043E\\u0442\\u043F\\u0440\\u0430\\u0432\\u0438\\u0442\\u044C \\u0441\\u043D\\u043E\\u0432\\u0430\"})]})})]})})]});}","map":{"version":3,"names":["React","useEffect","useState","toast","Toaster","useAuthStore","generateOTP","verifyOTP","useNavigate","styles","Recovery","state","auth","username","OTP","setOTP","navigate","then","success","error","onSubmit","e","preventDefault","console","log","code","status","resendOTP","sendPromise","promise","loading","glass","target","value","textbox","btn"],"sources":["C:/Users/Porhc/OneDrive/Рабочий стол/oil/client/src/components/Recovery.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport toast, { Toaster } from 'react-hot-toast';\r\nimport { useAuthStore } from '../store/store';\r\nimport { generateOTP, verifyOTP } from '../helper/helper';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\n\r\nimport styles from '../styles/UserName.module.css';\r\n\r\n\r\nexport default function Recovery() {\r\n\r\n    const { username } = useAuthStore(state => state.auth);\r\n    const [OTP, setOTP] = useState('');\r\n    const navigate = useNavigate()\r\n\r\n    useEffect(() => {\r\n        generateOTP(username).then((OTP) => {\r\n            // console.log(OTP);\r\n            if(OTP) return toast.success('Код был выслан на вашу почту');\r\n            return toast.error('Возникла проблема при генерации вашего кода')\r\n        })\r\n    }, [username]);\r\n\r\n    async function onSubmit(e) {\r\n        e.preventDefault();\r\n        try {\r\n            console.log(\"Verifying OTP with:\", { username, code: OTP });\r\n            let { status } = await verifyOTP({ username, code: OTP });\r\n            if (status === 201) {\r\n                toast.success('Проверка успешна');\r\n                navigate('/reset');\r\n            } else {\r\n                toast.error('Код не правильный, проверьте свою почту');\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Error verifying OTP:\", error);\r\n            toast.error('Код не правильный, проверьте свою почту');\r\n        }\r\n    }\r\n\r\n    \r\n\r\n    //ручная отправка\r\n    function resendOTP(){\r\n        let sendPromise = generateOTP(username);\r\n\r\n        toast.promise(sendPromise, {\r\n            loading : 'Отправка',\r\n            success : <b>Код был отправлен на вашу почту</b>,\r\n            error : <b>Не получилось отправить</b>\r\n        });\r\n\r\n        sendPromise.then(OTP => {\r\n            // console.log(OTP)\r\n        })\r\n    }\r\n\r\n    return (\r\n        <div className=\"container mx-auto\">\r\n\r\n            <Toaster position='top-center' reverseOrder={false}></Toaster>\r\n\r\n            <div className='flex justify-center items-center h-screen'>\r\n                <div className={styles.glass}>\r\n                    <div className=\"title flex flex-col items-center\">\r\n                        <h4 className='text-5xl fotn-bold'>Восстановление пароля</h4>\r\n                        <span className='py-4 text-xl w-2/3 text-center text-gray-500'>\r\n                            Введите код для смены пароля.\r\n                        </span>\r\n                    </div>\r\n\r\n                    <form className='pt-20' onSubmit={onSubmit}>\r\n\r\n\r\n                <div className=\"textbox flex flex-col items-center gap-6\">\r\n\r\n                    <div className=\"input text-center\">\r\n                    <span className='py-4 text-sm text-left text-gray-500'>\r\n                        Ведите 6 значный код\r\n                    </span>\r\n                    <input onChange={(e) => setOTP(e.target.value) } className={styles.textbox} type=\"text\" placeholder='OTP' />\r\n                  </div>\r\n\r\n                  <button className={styles.btn} type='submit'>Восстановить пароль</button>\r\n              </div>\r\n                    </form>\r\n\r\n                    <div className=\"text-center py-4\">\r\n                            <span className='text-gray-500'>Код не пришел? <button onClick={resendOTP} className='text-red-500'>отправить снова</button></span>\r\n                           </div>\r\n\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}